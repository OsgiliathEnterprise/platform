#!/usr/bin/env bash

pip3 install docker
if [[ "$OSTYPE" == "linux-gnu" ]]; then
  echo "not implemented for linux, PR welcomed!"
elif [[ "$OSTYPE" == "darwin"* ]]; then
. ./configure-mac
fi

vagrant plugin update
vagrant plugin install vagrant-persistent-storage

rm -rf ~/.vagrant.d/boxes #remove vagrant box cache
rm -rf ~/.cache/molecule

for f in roles/*; do
    if [[ -d "$f" && $f != "roles/community" ]]; then
        cd $f
        . ./configure
        cd ../..
    fi
done
